= AMPnet Payout Service API Documentation
Version {version}, {date}
:doctype: book
:toc: left
:sectnums:
:toclevels: 2
:source-highlighter: prettify
:docinfo: shared
:icons: font

== Introduction
This document contains generated documentation for `AMPnet payout-service`. Payout service contains all endpoints
for managing payouts to asset holders.
Source code is available on https://github.com/AMPnet/payout-service[Github].

== Payout Info API
All endpoints are public and do not require `Authorization: Bearer JWT` header.
Chain ID (e.g. 80001) and asset contract address must be provided in the request path.

=== Get payout Merkle tree
Fetches the entire Merkle tree for the payout with specified parameters. Path arguments in order are: chain ID,
asset contract address, Merkle tree root hash.

.Request
include::{snippets}/PayoutInfoControllerApiTest/mustCorrectlyFetchPayoutTree/http-request.adoc[]
.Response
include::{snippets}/PayoutInfoControllerApiTest/mustCorrectlyFetchPayoutTree/http-response.adoc[]

=== Get payout Merkle tree path for account
Fetches the Merkle tree path for the payout with specified parameters for specified wallet address. Path arguments in
order are: chain ID, asset contract address, Merkle tree root hash, wallet address.

.Request
include::{snippets}/PayoutInfoControllerApiTest/mustCorrectlyFetchPayoutPathForSomeAccount/http-request.adoc[]
.Response
include::{snippets}/PayoutInfoControllerApiTest/mustCorrectlyFetchPayoutPathForSomeAccount/http-response.adoc[]

== Payout API
All endpoint require `Authorization: Bearer JWT` header.
Chain ID (e.g. 80001) and asset contract address must be provided in the request path.

=== Submit create payout task
Requests creation of payout Merkle tree for specified parameters. This endpoint will return task ID which can then be
used to fetch task info via another endpoint. Path arguments in order are: chain ID, asset contract address. Issuer
address is optional.

.Request
include::{snippets}/PayoutControllerApiTest/mustSuccessfullyCreatePayoutTaskForSomeAsset/http-request.adoc[]
.Response
include::{snippets}/PayoutControllerApiTest/mustSuccessfullyCreatePayoutTaskForSomeAsset/http-response.adoc[]

=== Fetch create payout task info
Fetches create payout task info. Possible task statuses are `PENDING`, `SUCCESS` and `FAILED`. Path argument is
the task ID.

.Request
include::{snippets}/PayoutControllerApiTest/mustSuccessfullyCreateAndExecutePayoutForSomeAsset/http-request.adoc[]
.Response
include::{snippets}/PayoutControllerApiTest/mustSuccessfullyCreateAndExecutePayoutForSomeAsset/http-response.adoc[]

=== Fetch list of payouts
Fetches all payouts for specified filters. Possible payout statuses are `PROOF_PENDING`, `PROOF_FAILED`, `PROOF_CREATED`
and `PAYOUT_CREATED`. Multiple values for `status` and `assetFactories` query parameters can be specified by separating
them with commas.

.Request
include::{snippets}/PayoutControllerApiTest/mustReturnAdminPayoutsForSomeIssuerAndOwner/http-request.adoc[]
.Response
include::{snippets}/PayoutControllerApiTest/mustReturnAdminPayoutsForSomeIssuerAndOwner/http-response.adoc[]

=== Fetch list of payouts for investor
Fetches claimable and claimed payouts for investor. Multiple values for `assetFactories` query parameter can be
specified by separating them with commas. Claimable payouts will also contain proof necessary to claim them via payout
manager contract.

.Request
include::{snippets}/PayoutControllerApiTest/mustReturnClaimedPayoutInfoForSomeInvestor/http-request.adoc[]
.Response
include::{snippets}/PayoutControllerApiTest/mustReturnClaimedPayoutInfoForSomeInvestor/http-response.adoc[]
